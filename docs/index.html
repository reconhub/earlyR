<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimation of Transmissibility in the Early Stages of a Disease Outbreak • earlyR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimation of Transmissibility in the Early Stages of a Disease Outbreak">
<meta property="og:description" content="Implements a simple, likelihood-based estimation of the reproduction number (R0) using a branching process with a Poisson likelihood. This model requires knowledge of the serial interval distribution, and dates of symptom onsets. Infectiousness is determined by weighting R0 by the probability mass function of the serial interval on the corresponding day. It is a simplified version of the model introduced by Cori et al. (2013) &lt;doi:10.1093/aje/kwt133&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">earlyR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/earlyR.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/reconhub/earlyR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="welcome-to-the-earlyr-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#welcome-to-the-earlyr-package" class="anchor"></a>Welcome to the <em>earlyR</em> package!</h1></div>
<p>This package implements simple estimation of infectiousness, as measured by the reproduction number (R), in the early stages of an outbreak. This estimation requires:</p>
<ul>
<li><p><strong>prior knowledge</strong>: the <strong>serial interval</strong> distribution, defined as the <em>mean</em> and <em>standard deviation</em> of the (Gamma) distribution. In general, these parameters are best taken from the literature.</p></li>
<li><p><strong>data</strong>: the daily <strong>incidence</strong> of the disease, including <strong>only confirmed and probable</strong> cases.</p></li>
</ul>
<div id="installing-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-the-package" class="anchor"></a>Installing the package</h2>
<p>To install the current stable, CRAN version of the package, type:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"earlyR"</span><span class="op">)</span></pre></div>
<p>To benefit from the latest features and bug fixes, install the development, <em>github</em> version of the package using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"reconhub/earlyR"</span><span class="op">)</span></pre></div>
<p>Note that this requires the package <em>devtools</em> installed.</p>
</div>
</div>
<div id="what-does-it-do" class="section level1">
<h1 class="hasAnchor">
<a href="#what-does-it-do" class="anchor"></a>What does it do?</h1>
<p>The main features of the package include:</p>
<ul>
<li><p><strong><code>get_R</code></strong>: a function to estimate <em>R</em> as well as the force of infection over time, from incidence data; output is an object of class <code>earlyR</code></p></li>
<li><p><strong><code>sample_R</code></strong>: a function to obtain a sample of likely <em>R</em> values</p></li>
<li><p><strong><code>plot</code></strong>: a function to visualise <code>earlyR</code> objects (<em>R</em> or force of infection).</p></li>
<li><p><strong><code>points</code></strong>: a function using <code>earlyR</code> objects to add the force of infection to an existing plot.</p></li>
</ul>
</div>
<div id="resources" class="section level1">
<h1 class="hasAnchor">
<a href="#resources" class="anchor"></a>Resources</h1>
<div id="worked-example" class="section level2">
<h2 class="hasAnchor">
<a href="#worked-example" class="anchor"></a>Worked example</h2>
<p>This example is a simplified version of the <a href="http://www.repidemicsconsortium.org/earlyR/articles/earlyR.html"><em>introductory vignette</em></a> (see section below), where <code>earlyR</code> is used in conjunction with other packages to assess infectiousness and growth potential of an early Ebola Virus Disease (EVD) outbreak. Here, we simply illustrate how <code>earlyR</code> can be used for assessing infectiousness based on a few confirmed/probable cases.</p>
<p>In this example we assume a small outbreak of Ebola Virus Disease (EVD), for which the serial interval has been previously characterised. We study a fake outbreak, for which we will quantify infectiousness (R), and then project future incidence using the package <a href="https://github.com/reconhub/projections"><em>projections</em></a>.</p>
<p>The fake data we consider consist of confirmed cases with the following symptom onset dates:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">

<span class="va">onset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2017-02-04"</span>, <span class="st">"2017-02-12"</span>, <span class="st">"2017-02-15"</span>,
                   <span class="st">"2017-02-23"</span>, <span class="st">"2017-03-01"</span>, <span class="st">"2017-03-01"</span>,
           <span class="st">"2017-03-02"</span>, <span class="st">"2017-03-03"</span>, <span class="st">"2017-03-03"</span><span class="op">)</span><span class="op">)</span>        </pre></div>
<p>We assume the current date is 21st March. We compute the daily incidence using the package <a href="https://github.com/reconhub/incidence"><em>incidence</em></a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.repidemicsconsortium.org/incidence/">incidence</a></span><span class="op">)</span>
<span class="va">today</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2017-03-21"</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://www.repidemicsconsortium.org/incidence/reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">onset</span>, last_date <span class="op">=</span> <span class="va">today</span><span class="op">)</span>
<span class="va">i</span>
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [9 cases from days 2017-02-04 to 2017-03-21]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 46 rows and 1 columns</span>
<span class="co">#&gt; $n: 9 cases in total</span>
<span class="co">#&gt; $dates: 46 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 1 day</span>
<span class="co">#&gt; $timespan: 46 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">i</span>, border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></pre></div>
<p><img src="reference/figures/README-incidence-1.png" style="display: block; margin: auto;"></p>
<p><strong>Note:</strong> It is <strong>very important to make sure that the last days without cases are included here</strong>. Omitting this information would lead to an over-estimation of the reproduction number (<em>R</em>).</p>
<p>For estimating <em>R</em>, we need estimates of the mean and standard deviation of the serial interval, i.e. the delay between primary and secondary symptom onset dates. This has been quantified durin the West African EVD outbreak (WHO Ebola Response Team (2014) NEJM 371:1481–1495):</p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">15.3</span> <span class="co"># mean in days days</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">9.3</span> <span class="co"># standard deviation in days</span></pre></div>
<p>The function <code>get_R</code> is then used to estimate the most likely values of <em>R</em>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.repidemicsconsortium.org/earlyR/">earlyR</a></span><span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_R.html">get_R</a></span><span class="op">(</span><span class="va">i</span>, si_mean <span class="op">=</span> <span class="va">mu</span>, si_sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>
<span class="va">res</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; /// Early estimate of reproduction number (R) //</span>
<span class="co">#&gt;  // class: earlyR, list</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  // Maximum-Likelihood estimate of R ($R_ml):</span>
<span class="co">#&gt; [1] 1.041041</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  // $lambda:</span>
<span class="co">#&gt;   NA 0.01838179 0.0273192 0.03514719 0.0414835 0.04623398...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  // $dates:</span>
<span class="co">#&gt; [1] "2017-02-04" "2017-02-05" "2017-02-06" "2017-02-07" "2017-02-08"</span>
<span class="co">#&gt; [6] "2017-02-09"</span>
<span class="co">#&gt; ...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  // $si (serial interval):</span>
<span class="co">#&gt; A discrete distribution</span>
<span class="co">#&gt;   name: gamma</span>
<span class="co">#&gt;   parameters:</span>
<span class="co">#&gt;     shape: 2.70655567117586</span>
<span class="co">#&gt;     scale: 5.65294117647059</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></pre></div>
<p><img src="reference/figures/README-estimate-1.png" style="display: block; margin: auto;"></p>
<p>The first figure shows the distribution of likely values of <em>R</em>, and the Maximum-Likelihood (ML) estimation. To derive other statistics for this distribution, we can use <code>sample_R</code> to get a large sample of likely <em>R</em> values, and then compute statistics on this sample:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="va">R_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sample_R.html">sample_R</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">R_val</span><span class="op">)</span> <span class="co"># basic stats</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.2603  0.9009  1.1211  1.1694  1.4139  2.6126</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">R_val</span><span class="op">)</span> <span class="co"># quartiles</span>
<span class="co">#&gt;        0%       25%       50%       75%      100% </span>
<span class="co">#&gt; 0.2602603 0.9009009 1.1211211 1.4139139 2.6126126</span>
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">R_val</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="co"># 95% credibility interval</span>
<span class="co">#&gt;      2.5%     97.5% </span>
<span class="co">#&gt; 0.5402903 1.9622122</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">R_val</span>, border <span class="op">=</span> <span class="st">"grey"</span>, col <span class="op">=</span> <span class="st">"navy"</span>,
     xlab <span class="op">=</span> <span class="st">"Values of R"</span>,
     main <span class="op">=</span> <span class="st">"Sample of likely R values"</span><span class="op">)</span></pre></div>
<p><img src="reference/figures/README-samples-1.png" style="display: block; margin: auto;"></p>
<p>Finally, we can also represent infectiousness over time using:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"lambdas"</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">onset</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">onset</span>, col <span class="op">=</span> <span class="st">"grey"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">today</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (position_stack).</span></pre></div>
<p><img src="reference/figures/README-lamdbas-1.png" style="display: block; margin: auto;"></p>
<p>This figure shows the global force of infection over time, with vertical grey bars the dates of symptom of onset. The dashed blue line indicates current day. Note that the vertical scale for the bars is arbitrary, and only represents the relative force of infection.</p>
</div>
<div id="vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#vignettes" class="anchor"></a>Vignettes</h2>
<p>`Currently available vignettes can be accessed from <em>R</em> using:</p>
<ul>
<li>
<code><a href="articles/earlyR.html">vignette("earlyR")</a></code>: an <a href="http://www.repidemicsconsortium.org/earlyR/articles/earlyR.html">introduction to <code>earlyR</code></a> using a simulated Ebola Virus Disease (EVD) outbreak; includes projections of future incidence using <em>projections</em>.</li>
</ul>
</div>
<div id="websites" class="section level2">
<h2 class="hasAnchor">
<a href="#websites" class="anchor"></a>Websites</h2>
<p>A dedicated website is still in development.</p>
</div>
<div id="getting-help-online" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-help-online" class="anchor"></a>Getting help online</h2>
<p>Bug reports and feature requests should be posted on <em>github</em> using the <a href="http://github.com/reconhub/earlyR/issues"><em>issue</em></a> system. All other questions should be posted on the <strong>RECON forum</strong>: <br><a href="http://www.repidemicsconsortium.org/forum/" class="uri">http://www.repidemicsconsortium.org/forum/</a></p>
<p>Contributions are welcome via <strong>pull requests</strong>.</p>
<p>Please note that this project is released with a <a href="CONDUCT.html">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=earlyR">https://​cloud.r-project.org/​package=earlyR</a>
</li>
<li>Browse source code at <br><a href="https://github.com/reconhub/earlyR/">https://​github.com/​reconhub/​earlyR/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/reconhub/earlyR/issues">https://​github.com/​reconhub/​earlyR/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Thibaut Jombart <br><small class="roles"> Author, maintainer </small>  </li>
<li>Anne Cori <br><small class="roles"> Author </small>  </li>
<li>Pierre Nouvellet <br><small class="roles"> Author </small>  </li>
<li>Janetta Skarp <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/reconhub/earlyR"><img src="https://travis-ci.org/reconhub/earlyR.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/thibautjombart/earlyr/branch/master"><img src="https://ci.appveyor.com/api/projects/status/spq4patqkwrtlcgt/branch/master?svg=true" alt="Build status"></a></li>
<li><a href="https://codecov.io/github/reconhub/earlyR?branch=master"><img src="https://codecov.io/github/reconhub/earlyR/coverage.svg?branch=master" alt="codecov.io"></a></li>
<li><a href="https://cran.r-project.org/package=earlyR"><img src="http://www.r-pkg.org/badges/version/earlyR" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Thibaut Jombart, Anne Cori, Pierre Nouvellet, Janetta Skarp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
